<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AcidDocument</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
<link rel="stylesheet" href="/src/styles/main.css">
</head>
<body>
<div class="login-screen" id="loginScreen">
<button class="btn btn-i btn-g theme-float" onclick="toggleTheme()">🌓</button>
<div class="login-box">
<div class="login-logo"><h1>Acid<span>Document</span></h1></div>
<div class="login-blocked" id="loginBlocked">🚫 접근이 차단되었습니다.<br>30분 후 자동 해제되거나 관리자에게 문의하세요.</div>
<div class="login-locked" id="loginLocked">🔒 로그인 시도 초과<br><span id="lockTimer">5:00</span> 후 다시 시도하세요.</div>
<div class="login-error" id="loginError"></div>
<form id="loginForm" onsubmit="handleLogin(event)">
<div class="fg"><label>아이디</label><input type="text" id="loginId" required autocomplete="username"></div>
<div class="fg"><label>비밀번호</label><input type="password" id="loginPw" required autocomplete="current-password"></div>
<button type="submit" class="btn btn-p">로그인</button>
</form>
</div>
</div>
<div class="modal-bg" id="pwChangeModal" role="dialog" aria-modal="true" aria-labelledby="pwChangeModal-title">
<div class="modal" style="max-width:420px">
<div class="modal-head"><h2 id="pwChangeModal-title">🔐 초기 설정</h2></div>
<div class="modal-body">
<p style="color:var(--t3);margin-bottom:18px;font-size:14px">닉네임과 새 비밀번호를 설정해주세요.</p>
<div class="fg"><label>닉네임 (표시 이름)</label><input type="text" id="pwNickname" placeholder="홍길동"></div>
<div class="fg"><label>현재 비밀번호</label><input type="password" id="pwCur"></div>
<div class="fg"><label>새 비밀번호</label><input type="password" id="pwNew"></div>
<div class="fg"><label>새 비밀번호 확인</label><input type="password" id="pwConfirm"></div>
</div>
<div class="modal-foot">
<button class="btn btn-s" onclick="skipPwChange()">나중에</button>
<button class="btn btn-p" onclick="submitPwChange()">저장</button>
</div>
</div>
</div>
<div class="wrap" id="appWrap" style="display:none">
<div class="mob-overlay" id="mobOverlay" onclick="closeMobile()"></div>
<aside class="sidebar" id="sidebar" role="navigation" aria-label="문서 탐색">
<div class="sb-head"><div class="sb-logo">A</div><span class="sb-title" id="wsName">AcidDocument</span></div>
<div class="sb-body">
<nav aria-label="사이드바 탐색">
<div class="sb-section"><div class="nav-item" role="button" tabindex="0" onclick="openSearch()"><span class="nav-icon">🔍</span><span class="nav-text">검색</span><span class="nav-badge">⌘K</span></div></div>
<div class="sb-section">
<div class="sb-section-title">바로가기</div>
<div class="nav-item" role="button" tabindex="0" onclick="showNotice()"><span class="nav-icon">📢</span><span class="nav-text">공지사항</span></div>
<div class="nav-item" role="button" tabindex="0" onclick="showRecent()"><span class="nav-icon">🕐</span><span class="nav-text">최근 문서</span></div>
<div class="nav-item" role="button" tabindex="0" onclick="showFavorites()"><span class="nav-icon">⭐</span><span class="nav-text">즐겨찾기</span></div>
<div class="nav-item" role="button" tabindex="0" onclick="showTemplates()"><span class="nav-icon">📋</span><span class="nav-text">템플릿</span></div>
<div class="nav-item trash-drop" id="trashDrop" role="button" tabindex="0" onclick="showTrash()"><span class="nav-icon">🗑️</span><span class="nav-text">휴지통</span></div>
</div>
</nav>
<div class="sb-section">
<div class="sb-section-title">페이지<button class="btn btn-i btn-g" onclick="createPage()">+</button></div>
<div id="pageTree"></div>
</div>
</div>
<div class="sb-foot">
<div class="user-card" onclick="openSettings()">
<div class="user-avatar admin" id="userAvatar">AD</div>
<div><div class="user-name" id="userName">admin</div><div class="user-role" id="userRole">관리자</div></div>
</div>
</div>
</aside>
<main class="main" role="main">
<div class="notice-bar" id="noticeBar"><span class="notice-text" id="noticeText"></span><span class="notice-close" onclick="closeNoticeBar()">✕</span></div>
<header>
<div class="toolbar">
<div class="toolbar-left"><button class="btn btn-i btn-g mob-menu" onclick="toggleMobile()">☰</button><div class="breadcrumb" id="breadcrumb"></div></div>
<div class="toolbar-right">
<button class="btn btn-i btn-g" onclick="toggleTheme()">🌓</button>
<button class="btn btn-i btn-g" onclick="openComments()">💬</button>
<button class="btn btn-i btn-g" onclick="openVersions()">📜</button>
<button class="btn btn-i btn-g" onclick="openExport()">📤</button>
<button class="btn btn-sm btn-s" id="editBtn" onclick="toggleEdit()" style="display:inline-flex">✏️ 수정</button>
<button class="btn btn-sm btn-s" id="deletePageBtn" onclick="deleteCurrentPage()" style="color:var(--err)">🗑️ 삭제</button>
<button class="btn btn-p btn-sm" id="saveBtn" onclick="saveAndExit()" style="display:none">💾 저장</button>
<button class="btn btn-s btn-sm" id="cancelBtn" onclick="cancelEdit()" style="display:none">취소</button>
</div>
</div>
</header>
<article><div class="editor-wrap" id="editorWrap">
<div class="editor-toolbar" id="editorToolbar">
<div class="toolbar-group">
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'h1',content:''})" title="제목1">H1</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'h2',content:''})" title="제목2">H2</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'h3',content:''})" title="제목3">H3</button>
</div>
<div class="toolbar-divider"></div>
<div class="toolbar-group">
<button class="toolbar-btn" onclick="undo()" title="실행취소 (Ctrl+Z)">↩</button>
<button class="toolbar-btn" onclick="redo()" title="다시실행 (Ctrl+Y)">↪</button>
</div>
<div class="toolbar-divider"></div>
<div class="toolbar-group">
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'bullet',content:''})" title="글머리">•</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'number',content:'',num:1})" title="번호">1.</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'todo',content:'',checked:false})" title="할일">☑</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'toggle',content:'',innerContent:'',open:false})" title="토글">▶</button>
</div>
<div class="toolbar-divider"></div>
<div class="toolbar-group">
<button class="toolbar-btn" onclick="insertImage()" title="이미지">🖼</button>
<button class="toolbar-btn" onclick="insertVideo()" title="동영상">🎬</button>
<button class="toolbar-btn" onclick="insertFile()" title="파일">📎</button>
<button class="toolbar-btn" onclick="insertPdf()" title="PDF">📄</button>
</div>
<div class="toolbar-divider"></div>
<div class="toolbar-group">
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'table',rows:[['','',''],['','','']]})" title="표">▦</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'code',content:'',lang:''})" title="코드">&lt;/&gt;</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'quote',content:''})" title="인용">"</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'callout',content:'',calloutType:'info'})" title="콜아웃">💡</button>
</div>
<div class="toolbar-divider"></div>
<div class="toolbar-group">
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'columns',colType:'col2',columns:['','']})" title="2열">▐▌</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'columns',colType:'col3',columns:['','','']})" title="3열">▐▐▌</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'divider'})" title="구분선">—</button>
<button class="toolbar-btn" onclick="insertBlock(getCurrentIdx()+1,{id:genId(),type:'toc'})" title="목차">📑</button>
</div>
<div class="side-toolbar" id="sideToolbar">
<div class="toolbar-divider"></div>
<button class="side-toolbar-btn" onclick="moveBlockUpCurrent()" title="위로 이동">⬆️</button>
<button class="side-toolbar-btn" onclick="moveBlockDownCurrent()" title="아래로 이동">⬇️</button>
<button class="side-toolbar-btn" onclick="dupBlockCurrent()" title="복제">📋</button>
<button class="side-toolbar-btn" onclick="addBlockBelowCurrent()" title="아래에 추가">➕</button>
<button class="side-toolbar-btn danger" onclick="deleteBlockCurrent()" title="삭제">🗑️</button>
<div class="toolbar-divider"></div>
<button class="side-toolbar-btn" onclick="openShortcutHelp()" title="단축키 (Ctrl+/)">⌨️</button>
</div>
</div>
<div class="editor-inner">
<div class="page-head">
<div class="page-icon" id="pageIcon" onclick="openIconPicker()">📄</div>
<input type="text" class="page-title" id="pageTitle" placeholder="제목 없음" oninput="onTitleChange()">
<div class="page-meta" id="pageMeta"></div>
<div class="page-tags" id="pageTags"></div>
</div>
<div class="editor" id="editor"></div>
<div class="backlinks" id="backlinks" style="display:none"></div>
</div>
</div></article>
</main>
<div class="panel" id="versionPanel">
<div class="panel-head"><h3>📜 버전 기록</h3><button class="btn btn-i btn-g" onclick="closePanel('versionPanel')">✕</button></div>
<div class="panel-body" id="versionList"></div>
</div>
<div class="panel" id="commentPanel">
<div class="panel-head"><h3>💬 댓글</h3><button class="btn btn-i btn-g" onclick="closePanel('commentPanel')">✕</button></div>
<div class="panel-body" id="commentList"></div>
<div class="panel-foot"><textarea id="commentInput" rows="3" placeholder="댓글..."></textarea><button class="btn btn-p" style="width:100%;margin-top:10px" onclick="addComment()">작성</button></div>
</div>
</div>
<div class="modal-bg" id="searchModal" role="dialog" aria-modal="true" aria-label="검색" onclick="if(event.target===this)closeModal('searchModal')"><div class="modal" style="max-width:560px"><div class="search-input-wrap"><input type="text" class="search-input" id="searchInput" placeholder="검색..." oninput="doSearch(this.value)"></div><div class="search-results" id="searchResults"></div></div></div>
<div class="modal-bg" id="settingsModal" role="dialog" aria-modal="true" aria-labelledby="settingsModal-title" onclick="if(event.target===this)closeModal('settingsModal')">
<div class="modal lg">
<div class="modal-head"><h2 id="settingsModal-title">⚙️ 설정</h2><button class="btn btn-i btn-g" onclick="closeModal('settingsModal')">✕</button></div>
<div class="tabs-head"><div class="tab-btn on" onclick="showSettingsTab('profile',this)">프로필</div><div class="tab-btn" onclick="showSettingsTab('users',this)">사용자</div><div class="tab-btn" onclick="showSettingsTab('storage',this)">저장소</div><div class="tab-btn" onclick="showSettingsTab('deletelog',this)">삭제 로그</div><div class="tab-btn" onclick="showSettingsTab('iplog',this)">접속 로그</div><div class="tab-btn" onclick="showSettingsTab('notice',this)">공지</div><div class="tab-btn" onclick="showSettingsTab('workspace',this)">워크스페이스</div></div>
<div class="tab-panel on" id="tabProfile">
<div class="fg"><label>아이디</label><input id="setUserId" readonly></div>
<div class="fg"><label>닉네임</label><input id="setNickname"></div>
<button class="btn btn-s" onclick="saveNickname()" style="margin-bottom:20px">닉네임 저장</button>
<div class="fg"><label>역할</label><input id="setUserRole" readonly></div>
<hr style="border:none;border-top:1px solid var(--bdr);margin:20px 0">
<div class="fg"><label>현재 비밀번호</label><input type="password" id="setPwCur"></div>
<div class="fg"><label>새 비밀번호</label><input type="password" id="setPwNew"></div>
<button class="btn btn-p" onclick="changePassword()">비밀번호 변경</button>
<hr style="border:none;border-top:1px solid var(--bdr);margin:20px 0">
<button class="btn btn-s" style="color:var(--err)" onclick="logout()">🚪 로그아웃</button>
</div>
<div class="tab-panel" id="tabUsers">
<table class="dtable" id="usersTable"></table>
<hr style="border:none;border-top:1px solid var(--bdr);margin:20px 0">
<div style="display:flex;gap:12px"><div class="fg" style="flex:1"><label>아이디</label><input id="newUserId" readonly></div><div class="fg" style="flex:1"><label>비밀번호</label><input id="newUserPw" readonly></div></div>
<div style="display:flex;gap:12px;margin-top:12px">
<button class="btn btn-p" onclick="createUser()">사용자 생성</button>
<button class="btn btn-s" onclick="exportUsers()">📋 계정 목록 내보내기</button>
</div>
</div>
<div class="tab-panel" id="tabNotice">
<div class="fg"><label>공지사항 내용</label><textarea id="noticeContent" rows="4" placeholder="공지사항을 입력하세요..."></textarea></div>
<div style="display:flex;gap:10px">
<button class="btn btn-p" onclick="saveNotice()">공지 저장</button>
<button class="btn btn-d" onclick="clearNotice()">공지 삭제</button>
</div>
</div>
<div class="tab-panel" id="tabStorage">
<div style="margin-bottom:20px">
<h3 style="margin-bottom:12px;font-size:16px">📦 저장소 사용량</h3>
<div id="storageUsageBar" style="background:var(--bg3);border-radius:8px;height:24px;overflow:hidden;margin-bottom:8px">
<div id="storageUsageFill" style="height:100%;background:var(--acc);transition:width 0.3s"></div>
</div>
<div id="storageUsageText" style="font-size:13px;color:var(--t3)"></div>
</div>
<div style="padding:16px;background:var(--bg3);border-radius:8px;font-size:13px;margin-bottom:16px">
<p style="margin-bottom:12px"><strong>⚙️ 이미지 저장 방식</strong></p>
<label style="display:flex;align-items:center;gap:8px;cursor:pointer;margin-bottom:8px">
<input type="radio" name="imgStorage" value="storage" id="imgStorageOn" onchange="setImageStorageMode('storage')">
<span><strong>Storage 사용</strong> (권장) - 이미지를 Firebase Storage에 저장</span>
</label>
<label style="display:flex;align-items:center;gap:8px;cursor:pointer">
<input type="radio" name="imgStorage" value="base64" id="imgStorageOff" onchange="setImageStorageMode('base64')">
<span><strong>Base64 사용</strong> - 이미지를 문서에 직접 저장 (1MB 제한 주의)</span>
</label>
</div>
<div style="padding:16px;background:var(--bg3);border-radius:8px;font-size:13px;color:var(--t3);margin-bottom:16px">
<p style="margin-bottom:8px"><strong>📌 용량 제한</strong></p>
<ul style="margin-left:16px;line-height:1.8">
<li>총 저장 공간: 5GB</li>
<li>파일당 최대: 10MB</li>
<li>허용 이미지: JPEG, PNG, GIF, WebP</li>
</ul>
</div>
<div style="padding:16px;background:var(--bg3);border-radius:8px;font-size:13px">
<p style="margin-bottom:12px"><strong>🔄 이미지 마이그레이션</strong></p>
<p style="color:var(--t3);margin-bottom:12px">기존 base64 이미지를 Storage로 이전합니다.<br>Firestore 문서 크기 오류 해결에 필요합니다.</p>
<div id="migrationStatus" style="margin-bottom:12px;padding:8px;background:var(--bg2);border-radius:4px;display:none"></div>
<button class="btn btn-p" onclick="migrateImages()">마이그레이션 시작</button>
</div>
</div>
<div class="tab-panel" id="tabDeletelog">
<div style="margin-bottom:12px;display:flex;justify-content:space-between;align-items:center">
<span style="color:var(--t4);font-size:13px">최근 200개 삭제 기록 (최고관리자 전용)</span>
<button class="btn btn-sm btn-s" onclick="clearDeleteLog()">로그 삭제</button>
</div>
<div id="deleteLogList" style="max-height:400px;overflow-y:auto"></div>
</div>
<div class="tab-panel" id="tabIplog">
<div style="margin-bottom:12px;display:flex;justify-content:space-between;align-items:center">
<span style="color:var(--t4);font-size:13px">최근 100개 접속 시도 기록</span>
<button class="btn btn-sm btn-s" onclick="clearIpLog()">로그 삭제</button>
</div>
<div id="ipLogList" style="max-height:400px;overflow-y:auto"></div>
</div>
<div class="tab-panel" id="tabWorkspace"><div class="fg"><label>워크스페이스 이름</label><input id="setWsName"></div><button class="btn btn-p" onclick="saveWorkspace()">저장</button></div>
</div>
</div>
<div class="modal-bg" id="noticeModal" role="dialog" aria-modal="true" aria-labelledby="noticeModal-title" onclick="if(event.target===this)closeModal('noticeModal')"><div class="modal"><div class="modal-head"><h2 id="noticeModal-title">📢 공지사항</h2><button class="btn btn-i btn-g" onclick="closeModal('noticeModal')">✕</button></div><div class="modal-body" id="noticeBody" style="white-space:pre-wrap"></div></div></div>
<div class="modal-bg" id="exportModal" role="dialog" aria-modal="true" aria-labelledby="exportModal-title" onclick="if(event.target===this)closeModal('exportModal')"><div class="modal" style="max-width:360px"><div class="modal-head"><h2 id="exportModal-title">📤 내보내기</h2><button class="btn btn-i btn-g" onclick="closeModal('exportModal')">✕</button></div><div class="modal-body"><div class="nav-item" onclick="exportDoc('md')"><span class="nav-icon">📝</span><span class="nav-text">Markdown</span></div><div class="nav-item" onclick="exportDoc('html')"><span class="nav-icon">🌐</span><span class="nav-text">HTML</span></div><div class="nav-item" onclick="exportDoc('txt')"><span class="nav-icon">📄</span><span class="nav-text">텍스트</span></div><div class="nav-item" onclick="exportDoc('pdf')"><span class="nav-icon">📑</span><span class="nav-text">PDF</span></div></div></div></div>
<div class="modal-bg" id="iconModal" role="dialog" aria-modal="true" aria-labelledby="iconModal-title" onclick="if(event.target===this)closeModal('iconModal')"><div class="modal"><div class="modal-head"><h2 id="iconModal-title">🎨 아이콘</h2><button class="btn btn-i btn-g" onclick="closeModal('iconModal')">✕</button></div><div class="modal-body"><div class="icon-grid" id="iconGrid"></div></div></div></div>
<div class="modal-bg" id="trashModal" role="dialog" aria-modal="true" aria-labelledby="trashModal-title" onclick="if(event.target===this)closeModal('trashModal')"><div class="modal lg"><div class="modal-head"><h2 id="trashModal-title">🗑️ 휴지통</h2><button class="btn btn-i btn-g" onclick="closeModal('trashModal')">✕</button></div><div class="modal-body" id="trashList"></div><div class="modal-foot" id="trashFoot" style="display:none"><button class="btn btn-d" onclick="emptyTrash()">휴지통 비우기</button></div></div></div>
<div class="modal-bg" id="recentModal" role="dialog" aria-modal="true" aria-labelledby="recentModal-title" onclick="if(event.target===this)closeModal('recentModal')"><div class="modal"><div class="modal-head"><h2 id="recentModal-title">🕐 최근</h2><button class="btn btn-i btn-g" onclick="closeModal('recentModal')">✕</button></div><div class="modal-body" id="recentList"></div></div></div>
<div class="modal-bg" id="favoritesModal" role="dialog" aria-modal="true" aria-labelledby="favoritesModal-title" onclick="if(event.target===this)closeModal('favoritesModal')"><div class="modal"><div class="modal-head"><h2 id="favoritesModal-title">⭐ 즐겨찾기</h2><button class="btn btn-i btn-g" onclick="closeModal('favoritesModal')">✕</button></div><div class="modal-body" id="favoritesList"></div></div></div>
<div class="modal-bg" id="templatesModal" role="dialog" aria-modal="true" aria-labelledby="templatesModal-title" onclick="if(event.target===this)closeModal('templatesModal')"><div class="modal"><div class="modal-head"><h2 id="templatesModal-title">📋 템플릿</h2><button class="btn btn-i btn-g" onclick="closeModal('templatesModal')">✕</button></div><div class="modal-body" id="templatesList"></div></div></div>
<div class="modal-bg" id="imageModal" role="dialog" aria-modal="true" aria-labelledby="imageModal-title" onclick="if(event.target===this)closeModal('imageModal')"><div class="modal" style="max-width:420px"><div class="modal-head"><h2 id="imageModal-title">🖼️ 이미지</h2><button class="btn btn-i btn-g" onclick="closeModal('imageModal')">✕</button></div><div class="modal-body"><div class="fg"><label>이미지 URL</label><input id="imageUrl" placeholder="https://..."></div><button class="btn btn-p" onclick="insertImage()">삽입</button></div></div></div>
<div class="modal-bg" id="videoModal" role="dialog" aria-modal="true" aria-labelledby="videoModal-title" onclick="if(event.target===this)closeModal('videoModal')"><div class="modal" style="max-width:420px"><div class="modal-head"><h2 id="videoModal-title">🎬 동영상</h2><button class="btn btn-i btn-g" onclick="closeModal('videoModal')">✕</button></div><div class="modal-body"><div class="fg"><label>YouTube URL</label><input id="videoUrl" placeholder="https://youtube.com/..."></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('videoModal')">취소</button><button class="btn btn-p" onclick="insertVideo()">삽입</button></div></div></div>
<div class="modal-bg" id="pdfModal" role="dialog" aria-modal="true" aria-labelledby="pdfModal-title" onclick="if(event.target===this)closeModal('pdfModal')"><div class="modal" style="max-width:420px"><div class="modal-head"><h2 id="pdfModal-title">📄 PDF</h2><button class="btn btn-i btn-g" onclick="closeModal('pdfModal')">✕</button></div><div class="modal-body"><div class="fg"><label>PDF URL</label><input id="pdfUrl" placeholder="https://..."></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('pdfModal')">취소</button><button class="btn btn-p" onclick="insertPdf()">삽입</button></div></div></div>
<div class="modal-bg" id="fileModal" role="dialog" aria-modal="true" aria-labelledby="fileModal-title" onclick="if(event.target===this)closeModal('fileModal')"><div class="modal" style="max-width:420px"><div class="modal-head"><h2 id="fileModal-title">📎 파일</h2><button class="btn btn-i btn-g" onclick="closeModal('fileModal')">✕</button></div><div class="modal-body"><div class="fg"><label>파일 URL</label><input id="fileUrl" placeholder="https://github.com/..."></div><div class="fg"><label>파일명</label><input id="fileName" placeholder="파일명.확장자"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('fileModal')">취소</button><button class="btn btn-p" onclick="insertFile()">삽입</button></div></div></div>
<div class="modal-bg" id="colorModal" role="dialog" aria-modal="true" aria-labelledby="colorModal-title" onclick="if(event.target===this)closeModal('colorModal')"><div class="modal" style="max-width:320px"><div class="modal-head"><h2 id="colorModal-title">🎨 텍스트 색상</h2><button class="btn btn-i btn-g" onclick="closeModal('colorModal')">✕</button></div><div class="modal-body"><div class="color-grid" id="colorGrid"></div></div></div></div>
<div class="modal-bg" id="tagModal" role="dialog" aria-modal="true" aria-labelledby="tagModal-title" onclick="if(event.target===this)closeModal('tagModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="tagModal-title">🏷️ 태그 추가</h2><button class="btn btn-i btn-g" onclick="closeModal('tagModal')">✕</button></div><div class="modal-body"><div class="fg"><label>태그 이름</label><input type="text" id="tagInput" placeholder="예: 중요, 진행중, 완료"></div><div style="margin-top:12px"><p style="font-size:13px;color:var(--t4);margin-bottom:8px">추천 태그</p><div style="display:flex;flex-wrap:wrap;gap:6px"><span class="tag" style="cursor:pointer" onclick="quickTag('중요')">🔴 중요</span><span class="tag" style="cursor:pointer" onclick="quickTag('진행중')">🟡 진행중</span><span class="tag" style="cursor:pointer" onclick="quickTag('완료')">🟢 완료</span><span class="tag" style="cursor:pointer" onclick="quickTag('검토필요')">🔵 검토필요</span></div></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('tagModal')">취소</button><button class="btn btn-p" onclick="submitTag()">추가</button></div></div></div>
<div class="modal-bg" id="editCommentModal" role="dialog" aria-modal="true" aria-labelledby="editCommentModal-title" onclick="if(event.target===this)closeModal('editCommentModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="editCommentModal-title">✏️ 댓글 수정</h2><button class="btn btn-i btn-g" onclick="closeModal('editCommentModal')">✕</button></div><div class="modal-body"><div class="fg"><label>댓글 내용</label><textarea id="editCommentInput" rows="4"></textarea></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('editCommentModal')">취소</button><button class="btn btn-p" onclick="submitEditComment()">저장</button></div></div></div>
<div class="modal-bg" id="imageUploadModal" role="dialog" aria-modal="true" aria-labelledby="imageUploadModal-title" onclick="if(event.target===this)closeModal('imageUploadModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="imageUploadModal-title">🖼️ 이미지 삽입</h2><button class="btn btn-i btn-g" onclick="closeModal('imageUploadModal')">✕</button></div><div class="modal-body"><div class="fg"><label>URL로 삽입</label><input type="text" id="imageUrlInput" placeholder="https://..."></div><div style="text-align:center;margin:16px 0;color:var(--t4)">또는</div><div class="fg"><label>파일 업로드</label><input type="file" id="imageFileInput" accept="image/*"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('imageUploadModal')">취소</button><button class="btn btn-p" onclick="submitImage()">삽입</button></div></div></div>
<div class="modal-bg" id="slideImageModal" role="dialog" aria-modal="true" aria-labelledby="slideImageModal-title" onclick="if(event.target===this)closeModal('slideImageModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="slideImageModal-title">🎠 슬라이드 이미지 추가</h2><button class="btn btn-i btn-g" onclick="closeModal('slideImageModal')">✕</button></div><div class="modal-body"><div class="fg"><label>URL로 삽입</label><input type="text" id="slideImageUrlInput" placeholder="https://..."></div><div style="text-align:center;margin:16px 0;color:var(--t4)">또는</div><div class="fg"><label>파일 업로드</label><input type="file" id="slideImageFileInput" accept="image/*"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('slideImageModal')">취소</button><button class="btn btn-p" onclick="submitSlideImage()">추가</button></div></div></div>
<div class="modal-bg" id="videoUploadModal" role="dialog" aria-modal="true" aria-labelledby="videoUploadModal-title" onclick="if(event.target===this)closeModal('videoUploadModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="videoUploadModal-title">🎬 동영상 삽입</h2><button class="btn btn-i btn-g" onclick="closeModal('videoUploadModal')">✕</button></div><div class="modal-body"><div class="fg"><label>YouTube URL</label><input type="text" id="videoUrlInput" placeholder="https://youtube.com/..."></div><div style="text-align:center;margin:16px 0;color:var(--t4)">또는</div><div class="fg"><label>파일 업로드</label><input type="file" id="videoFileInput" accept="video/*"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('videoUploadModal')">취소</button><button class="btn btn-p" onclick="submitVideo()">삽입</button></div></div></div>
<div class="modal-bg" id="pdfUploadModal" role="dialog" aria-modal="true" aria-labelledby="pdfUploadModal-title" onclick="if(event.target===this)closeModal('pdfUploadModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="pdfUploadModal-title">📑 PDF 삽입</h2><button class="btn btn-i btn-g" onclick="closeModal('pdfUploadModal')">✕</button></div><div class="modal-body"><div class="fg"><label>URL로 삽입</label><input type="text" id="pdfUrlInput" placeholder="https://...pdf"></div><div style="text-align:center;margin:16px 0;color:var(--t4)">또는</div><div class="fg"><label>파일 업로드</label><input type="file" id="pdfFileInput" accept=".pdf"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('pdfUploadModal')">취소</button><button class="btn btn-p" onclick="submitPdf()">삽입</button></div></div></div>
<div class="modal-bg" id="fileUploadModal" role="dialog" aria-modal="true" aria-labelledby="fileUploadModal-title" onclick="if(event.target===this)closeModal('fileUploadModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="fileUploadModal-title">📎 파일 삽입</h2><button class="btn btn-i btn-g" onclick="closeModal('fileUploadModal')">✕</button></div><div class="modal-body"><div class="fg"><label>파일 업로드</label><input type="file" id="fileFileInput"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('fileUploadModal')">취소</button><button class="btn btn-p" onclick="submitFile()">삽입</button></div></div></div>
<div class="modal-bg" id="bookmarkModal" role="dialog" aria-modal="true" aria-labelledby="bookmarkModal-title" onclick="if(event.target===this)closeModal('bookmarkModal')"><div class="modal" style="max-width:450px"><div class="modal-head"><h2 id="bookmarkModal-title">🔗 북마크 삽입</h2><button class="btn btn-i btn-g" onclick="closeModal('bookmarkModal')">✕</button></div><div class="modal-body"><div class="fg"><label>URL</label><input type="text" id="bookmarkUrlInput" placeholder="https://..."></div><div class="fg"><label>제목 (선택)</label><input type="text" id="bookmarkTitleInput" placeholder="자동 감지됨"></div><div class="fg"><label>설명 (선택)</label><input type="text" id="bookmarkDescInput" placeholder="자동 감지됨"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('bookmarkModal')">취소</button><button class="btn btn-p" onclick="submitBookmark()">삽입</button></div></div></div>
<div class="modal-bg" id="calloutIconModal" role="dialog" aria-modal="true" aria-labelledby="calloutIconModal-title" onclick="if(event.target===this)closeModal('calloutIconModal')"><div class="modal" style="max-width:360px"><div class="modal-head"><h2 id="calloutIconModal-title">💡 콜아웃 아이콘</h2><button class="btn btn-i btn-g" onclick="closeModal('calloutIconModal')">✕</button></div><div class="modal-body"><div class="icon-grid" id="calloutIconGrid"></div></div></div></div>
<div class="modal-bg" id="codeSettingModal" role="dialog" aria-modal="true" aria-labelledby="codeSettingModal-title" onclick="if(event.target===this)closeModal('codeSettingModal')"><div class="modal" style="max-width:360px"><div class="modal-head"><h2 id="codeSettingModal-title">💻 코드 설정</h2><button class="btn btn-i btn-g" onclick="closeModal('codeSettingModal')">✕</button></div><div class="modal-body"><div class="fg"><label>언어/제목</label><input type="text" id="codeLangInput" placeholder="javascript, python, etc."></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('codeSettingModal')">취소</button><button class="btn btn-p" onclick="submitCodeLang()">저장</button></div></div></div>
<div class="modal-bg" id="calEventModal" role="dialog" aria-modal="true" aria-labelledby="calEventModalTitle" onclick="if(event.target===this)closeModal('calEventModal')"><div class="modal" style="max-width:420px"><div class="modal-head"><h2 id="calEventModalTitle">📅 일정</h2><button class="btn btn-i btn-g" onclick="closeModal('calEventModal')">✕</button></div><div class="modal-body"><div id="calEventList" class="event-list" style="margin-bottom:16px"></div><div style="border-top:1px solid var(--bdr);padding-top:16px"><p style="font-weight:600;margin-bottom:12px">새 일정 추가</p><div class="fg"><label>제목</label><input type="text" id="calEventTitle" placeholder="일정 제목"></div><div style="display:flex;gap:12px"><div class="fg" style="flex:1"><label>시작일</label><input type="date" id="calEventStartDate"></div><div class="fg" style="flex:1"><label>종료일</label><input type="date" id="calEventEndDate"></div></div><div class="fg"><label>색상</label><div style="display:flex;gap:6px;flex-wrap:wrap" id="calEventColors"></div></div></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('calEventModal')">닫기</button><button class="btn btn-p" onclick="addCalEvent()">일정 추가</button></div></div></div>
<div class="modal-bg" id="tableAlignModal" role="dialog" aria-modal="true" aria-labelledby="tableAlignModal-title" onclick="if(event.target===this)closeModal('tableAlignModal')"><div class="modal" style="max-width:320px"><div class="modal-head"><h2 id="tableAlignModal-title">📊 표 설정</h2><button class="btn btn-i btn-g" onclick="closeModal('tableAlignModal')">✕</button></div><div class="modal-body"><div class="fg"><label>텍스트 정렬</label><div style="display:flex;gap:8px"><button class="btn btn-s" onclick="setTblAlign('left')">왼쪽</button><button class="btn btn-s" onclick="setTblAlign('center')">가운데</button><button class="btn btn-s" onclick="setTblAlign('right')">오른쪽</button></div></div><div class="fg" style="margin-top:16px"><button class="btn btn-s" style="width:100%;color:var(--err)" onclick="deleteTable()">🗑️ 표 삭제</button></div></div></div></div>
<div class="modal-bg" id="colWidthModal" role="dialog" aria-modal="true" aria-labelledby="colWidthModal-title" onclick="if(event.target===this)closeModal('colWidthModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="colWidthModal-title">📏 열 너비 조정</h2><button class="btn btn-i btn-g" onclick="closeModal('colWidthModal')">✕</button></div><div class="modal-body"><p style="font-size:13px;color:var(--t4);margin-bottom:16px">각 열의 너비를 % 단위로 입력하세요. 합계가 100%가 되도록 조정하세요.</p><div id="colWidthInputs"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('colWidthModal')">취소</button><button class="btn btn-p" onclick="applyColWidths()">적용</button></div></div></div>
<div class="modal-bg" id="deleteConfirmModal" role="dialog" aria-modal="true" aria-labelledby="deleteConfirmModal-title" onclick="if(event.target===this)closeModal('deleteConfirmModal')"><div class="modal" style="max-width:360px"><div class="modal-head"><h2 id="deleteConfirmModal-title">🗑️ 삭제 확인</h2></div><div class="modal-body"><p id="deleteConfirmText">이 페이지를 삭제하시겠습니까?</p></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('deleteConfirmModal')">취소</button><button class="btn btn-d" onclick="confirmDelete()">삭제</button></div></div></div>
<div class="modal-bg" id="shortcutModal" role="dialog" aria-modal="true" aria-labelledby="shortcutModal-title" onclick="if(event.target===this)closeModal('shortcutModal')"><div class="modal" style="max-width:480px"><div class="modal-head"><h2 id="shortcutModal-title">⌨️ 단축키 안내</h2><button class="btn btn-i btn-g" onclick="closeModal('shortcutModal')">✕</button></div><div class="modal-body" style="max-height:60vh;overflow-y:auto">
<div style="margin-bottom:16px"><h4 style="color:var(--acc);margin-bottom:8px">📝 편집</h4><div class="shortcut-row"><span>Ctrl + S</span><span>저장</span></div><div class="shortcut-row"><span>Ctrl + K</span><span>검색</span></div><div class="shortcut-row"><span>Ctrl + B</span><span>굵게</span></div><div class="shortcut-row"><span>Ctrl + I</span><span>기울임</span></div><div class="shortcut-row"><span>Ctrl + U</span><span>밑줄</span></div><div class="shortcut-row"><span>Ctrl + /</span><span>단축키 안내</span></div></div>
<div style="margin-bottom:16px"><h4 style="color:var(--acc);margin-bottom:8px">📦 블록</h4><div class="shortcut-row"><span>/</span><span>슬래시 메뉴</span></div><div class="shortcut-row"><span>Enter</span><span>새 블록</span></div><div class="shortcut-row"><span>Shift + Enter</span><span>줄바꿈</span></div><div class="shortcut-row"><span>Backspace</span><span>블록 삭제 (빈 블록)</span></div><div class="shortcut-row"><span>Tab</span><span>들여쓰기</span></div></div>
<div><h4 style="color:var(--acc);margin-bottom:8px">🏷️ 태그/멘션</h4><div class="shortcut-row"><span>@사용자</span><span>멘션</span></div><div class="shortcut-row"><span>ESC</span><span>메뉴 닫기</span></div></div>
</div></div></div>
<div class="modal-bg" id="emojiModal" role="dialog" aria-modal="true" aria-labelledby="emojiModal-title" onclick="if(event.target===this)closeModal('emojiModal')"><div class="modal" style="max-width:360px"><div class="modal-head"><h2 id="emojiModal-title">😀 이모지</h2><button class="btn btn-i btn-g" onclick="closeModal('emojiModal')">✕</button></div><div class="modal-body"><input type="text" id="emojiSearch" placeholder="검색..." oninput="filterEmoji(this.value)" style="margin-bottom:12px"><div class="emoji-grid" id="emojiGrid"></div></div></div></div>
<div class="modal-bg" id="mentionModal" role="dialog" aria-modal="true" aria-labelledby="mentionModal-title" onclick="if(event.target===this)closeModal('mentionModal')"><div class="modal" style="max-width:320px"><div class="modal-head"><h2 id="mentionModal-title">👤 사용자 멘션</h2><button class="btn btn-i btn-g" onclick="closeModal('mentionModal')">✕</button></div><div class="modal-body"><div id="mentionUserList"></div></div></div></div>
<div class="modal-bg" id="renamePageModal" role="dialog" aria-modal="true" aria-labelledby="renamePageModal-title" onclick="if(event.target===this)closeModal('renamePageModal')"><div class="modal" style="max-width:360px"><div class="modal-head"><h2 id="renamePageModal-title">✏️ 이름 변경</h2><button class="btn btn-i btn-g" onclick="closeModal('renamePageModal')">✕</button></div><div class="modal-body"><div class="fg"><label>페이지 이름</label><input type="text" id="renamePageInput" placeholder="새 이름"></div></div><div class="modal-foot"><button class="btn btn-s" onclick="closeModal('renamePageModal')">취소</button><button class="btn btn-p" onclick="submitRenamePage()">변경</button></div></div></div>
<div class="modal-bg" id="userTagModal" role="dialog" aria-modal="true" aria-labelledby="userTagModal-title" onclick="if(event.target===this)closeModal('userTagModal')"><div class="modal" style="max-width:320px"><div class="modal-head"><h2 id="userTagModal-title">👤 작업자 추가</h2><button class="btn btn-i btn-g" onclick="closeModal('userTagModal')">✕</button></div><div class="modal-body"><div id="userTagList"></div></div></div></div>
<div class="modal-bg" id="pageLinkModal" role="dialog" aria-modal="true" aria-labelledby="pageLinkModal-title" onclick="if(event.target===this)closeModal('pageLinkModal')"><div class="modal" style="max-width:400px"><div class="modal-head"><h2 id="pageLinkModal-title">🔗 페이지 링크</h2><button class="btn btn-i btn-g" onclick="closeModal('pageLinkModal')">✕</button></div><div class="modal-body"><input type="text" id="pageLinkSearch" placeholder="페이지 검색..." oninput="filterPageLinks(this.value)" style="margin-bottom:12px"><div id="pageLinkList"></div></div></div></div>
<div class="ctx-menu" id="ctxMenu" role="menu" aria-label="컨텍스트 메뉴"></div>
<div class="slash-menu" id="slashMenu" role="listbox" aria-label="블록 유형 선택"></div>
<div class="tag-picker" id="tagPicker">
<div class="tag-picker-colors">
<div class="tag-picker-color" style="background:#fee2e2" data-color="red" onclick="changeTagColor('red')"></div>
<div class="tag-picker-color" style="background:#ffedd5" data-color="orange" onclick="changeTagColor('orange')"></div>
<div class="tag-picker-color" style="background:#fef9c3" data-color="yellow" onclick="changeTagColor('yellow')"></div>
<div class="tag-picker-color" style="background:#dcfce7" data-color="green" onclick="changeTagColor('green')"></div>
<div class="tag-picker-color" style="background:#dbeafe" data-color="blue" onclick="changeTagColor('blue')"></div>
<div class="tag-picker-color" style="background:#f3e8ff" data-color="purple" onclick="changeTagColor('purple')"></div>
<div class="tag-picker-color" style="background:#fce7f3" data-color="pink" onclick="changeTagColor('pink')"></div>
<div class="tag-picker-color" style="background:#f3f4f6" data-color="gray" onclick="changeTagColor('gray')"></div>
</div>
<button class="btn btn-sm" style="width:100%;background:var(--err);color:#fff" onclick="removeInlineTag()">태그 삭제</button>
</div>
<div class="fmt-bar" id="fmtBar">
<button class="btn btn-i btn-g" onclick="fmtCmd('bold')" title="굵게"><b>B</b></button>
<button class="btn btn-i btn-g" onclick="fmtCmd('italic')" title="기울임"><i>I</i></button>
<button class="btn btn-i btn-g" onclick="fmtCmd('underline')" title="밑줄"><u>U</u></button>
<button class="btn btn-i btn-g" onclick="fmtCmd('justifyLeft')" title="왼쪽">⫷</button>
<button class="btn btn-i btn-g" onclick="fmtCmd('justifyCenter')" title="가운데">☰</button>
<button class="btn btn-i btn-g" onclick="fmtCmd('justifyRight')" title="오른쪽">⫸</button>
<button class="btn btn-i btn-g" onclick="openColorPicker()" title="색상">🎨</button>
</div>
<div class="toast-wrap" id="toastWrap"></div>
<div class="image-viewer" id="imageViewer" onclick="closeImageViewer(event)">
<button class="image-viewer-close" onclick="closeImageViewer()">✕</button>
<button class="image-viewer-nav prev" id="viewerPrev" onclick="viewerNav(-1,event)">‹</button>
<img id="viewerImg" src="" alt="">
<button class="image-viewer-nav next" id="viewerNext" onclick="viewerNav(1,event)">›</button>
<div class="image-viewer-counter" id="viewerCounter"></div>
</div>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script type="module" src="/src/main.js"></script>
</body>
</html>