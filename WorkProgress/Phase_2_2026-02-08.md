Phase : Phase 2 — 보안 강화
Status : 진행 중
LastUpdate : 2026-02-08
Branch : refactor/phase-2-security
RecentWork : Task 2-3 XSS 방어 (DOMPurify 도입) 완료
MainWork :
  - [ ] Task 2-1: 기존 데이터 백업 스크립트 작성
  - [x] Task 2-2: Firebase Authentication 도입 (호환 레이어 포함)
  - [x] Task 2-3: XSS 방어 (DOMPurify 도입)
  - [ ] Task 2-4: 로그인 잠금 로직 개선
ResolvedWork :
  - Task 2-3: sanitize.js 생성 (sanitizeHTML + sanitizeURL), renderer.js 전체 블록 콘텐츠에 sanitizeHTML 적용 (text/h1-h3/bullet/number/todo/toggle/quote/callout/code/table/columns/image caption), export.js md/txt 콘텐츠에 sanitizeHTML 적용, media.js URL 입력 지점에 sanitizeURL 적용 (image/video/pdf/bookmark/slide), 37개 테스트 작성 및 통과
  - Task 2-2: Firebase Auth CDN 추가, auth 초기화, handleLogin 호환 레이어 (Auth 우선 + 레거시 폴백 + progressive migration), onAuthStateChanged 세션 복원, logout/isSuper/submitPwChange/changePassword 모두 양쪽 지원, firestore.rules 생성, migrate-auth.js 스크립트 생성
MainIssues :
  - 클라이언트 평문 비밀번호 + localStorage 세션 (P0 보안 취약점) → Firebase Auth 도입으로 부분 해결 (마이그레이션 필요)
  - 로그인 잠금이 클라이언트사이드 localStorage에만 저장 (우회 가능)
ResolvedIssues :
  - XSS 취약점 해결 (DOMPurify 기반 sanitizeHTML/sanitizeURL 도입, 전체 블록 innerHTML + 미디어 URL에 적용)
  - Firebase Auth 호환 레이어 구현 (기존 users[] 유지, 레거시 로그인 폴백 보장)
RelatedPhases : Phase 1 (완료), 전체 계획 docs/plans/2026-02-08-full-refactor.md 참고
