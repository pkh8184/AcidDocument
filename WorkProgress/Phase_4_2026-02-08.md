Phase : Phase 4 — 버그 수정
Status : 완료
LastUpdate : 2026-02-08
Branch : refactor/phase-4-bugfix
RecentWork : 8개 태스크 모두 완료 (3개는 Phase 1에서 이미 해결, 5개 신규 구현)
MainWork :
  - [x] Task 4-1: renderSidebar() 미정의 수정 (Phase 1에서 해결됨)
  - [x] Task 4-2: dupBlock() 이중 정의 수정 (Phase 1에서 해결됨)
  - [x] Task 4-3: 드래그앤드롭 imageStorage 설정 적용
  - [x] Task 4-4: hasChanges() 완전한 비교 (JSON.stringify)
  - [x] Task 4-5: 버전 ID 충돌 방지 (genId() + 타입 호환)
  - [x] Task 4-6: 테이블 조작 시 데이터 동기화 (Phase 1에서 해결됨)
  - [x] Task 4-7: recentIds 영속화 (localStorage)
  - [x] Task 4-8: 중복 CSS 규칙 제거
ResolvedWork :
  - Task 4-3: drop 핸들러에 imageStorage 설정 체크 추가 (paste 핸들러와 동일 로직)
  - Task 4-4: hasChanges()에서 content만 비교 → JSON.stringify 깊은 비교, 테스트 10개 추가
  - Task 4-5: saveDoc()에서 버전 ID를 genId()로 변경, renderVer에서 문자열 따옴표 처리, restoreVer/deleteVer에서 == 사용 (숫자/문자열 호환)
  - Task 4-7: saveRecent()/loadRecent() 추가, localStorage에 ad_recent 키로 백업
  - Task 4-8: .block-table, .col-divider::after, .block-col:focus-within, .icon-grid 중복 제거
MainIssues : (없음)
ResolvedIssues :
  - 드래그앤드롭 이미지가 항상 base64 → imageStorage 설정 반영
  - hasChanges()가 content만 비교 → 모든 속성 깊은 비교
  - 버전 ID 충돌 (삭제 후 재생성 시) → genId()로 해결
  - 기존 숫자 ID와 새 문자열 ID 호환 → == 사용
  - 최근 문서 목록 Firestore 의존 → localStorage 백업 추가
  - CSS 중복 규칙 12줄 제거
RelatedPhases : Phase 1 (완료), Phase 2 (완료), Phase 3 (완료), 전체 계획 docs/plans/2026-02-08-full-refactor.md 참고
